% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rehybridize.R
\name{rehybridize}
\alias{rehybridize}
\title{Virtual rehybridization with an array-to-sample assignment}
\usage{
rehybridize(smp.eff, ary.eff, group.id, group.id.level = c("E", "V"),
  ary.to.smp.assign, icombat = FALSE, isva = FALSE, iruv = FALSE,
  smp.eff.ctrl = NULL, ary.eff.ctrl = NULL)
}
\arguments{
\item{smp.eff}{the estimated sample effect dataset. The dataset must have rows as probes and columns as samples.}

\item{ary.eff}{the estimated array effect dataset. The dataset must have rows as probes and columns as samples.
It must have the same dimensions and the same probe names as the estimated sample effect dataset.}

\item{group.id}{a vector of sample-group labels for each sample of the estimated sample effect dataset.
It must be a 2-level non-numeric factor vector.}

\item{group.id.level}{a vector of sample-group label level. It must have two and only two elements and
the first element is the reference.
By default, \code{group.id.level = c("E", "V")}. That is in our study, we compare endometrial tumor samples to
ovarian tumor samples, with endometrial as our reference.}

\item{ary.to.smp.assign}{a vector of indices that assign arrays to samples (see details in \code{blocking.design},
\code{confounding.design} or \code{stratification.design}). It must have an equal length to the number of samples
in the estimated sample effect dataset.
The first half arrays in the vector have to be assigned to the sample group 1 and the second half to sample group 2.}

\item{icombat}{an indicator for combat adjustment. By default, \code{icombat = FALSE} for no ComBat adjustment.}

\item{isva}{an indicator for sva adjustment. By default, \code{isva = FALSE} for no sva adjustment.}

\item{iruv}{an indicator for RUV-4 adjustment. By default, \code{iruv = FALSE} for no RUV-4 adjustment.}

\item{smp.eff.ctrl}{the negative-control probe sample effect data if \code{iruv = TRUE}.
This dataset must have rows as probes and columns as samples.
It also must have the same number of samples and the same sample names as \code{smp.eff}.}

\item{ary.eff.ctrl}{the negative-control probe array effect data if \code{iruv = TRUE}.
It also must have the same dimensions and the same probe names as \code{smp.eff.ctrl}.}
}
\value{
simulated data, after batch adjustment if specified
}
\description{
Create simulated dataset through "virtual rehybridization" for a given array-to-sample assignment.
}
\examples{
\dontrun{
smp.eff <- estimate.smp.eff(uhdata = uhdata.pl)
ary.eff <- estimate.ary.eff(uhdata = uhdata.pl,
                             nuhdata = nuhdata.pl)

ctrl.genes <- unique(rownames(uhdata.pl))[grep("NC", unique(rownames(uhdata.pl)))]

smp.eff.nc <- smp.eff[!rownames(smp.eff) \%in\% ctrl.genes, ]
ary.eff.nc <- ary.eff[!rownames(ary.eff) \%in\% ctrl.genes, ]

assign.ind <- confounding.design(seed = 1, num.smp = 192,
degree = "complete", rev.order = FALSE)

group.id <- substr(colnames(smp.eff.nc), 7, 7)

# no batch effect adjustment (default)
sim.data.raw <- rehybridize(smp.eff = smp.eff.nc,
                            ary.eff = ary.eff.nc,
                            group.id = group.id,
                            ary.to.smp.assign = assign.ind)

# batch effect adjusting with sva
sim.data.sva <- rehybridize(smp.eff = smp.eff.nc,
                            ary.eff = ary.eff.nc,
                            group.id = group.id,
                            ary.to.smp.assign = assign.ind,
                            isva = TRUE)

# batch effect adjusting with RUV-4
smp.eff.ctrl <- smp.eff[rownames(smp.eff) \%in\% ctrl.genes, ]
ary.eff.ctrl <- ary.eff[rownames(ary.eff) \%in\% ctrl.genes, ]

sim.data.ruv <- rehybridize(smp.eff = smp.eff.nc,
                            ary.eff = ary.eff.nc,
                            group.id = group.id,
                            ary.to.smp.assign = assign.ind,
                            iruv = TRUE,
                            smp.eff.ctrl = smp.eff.ctrl,
                            ary.eff.ctrl = ary.eff.ctrl)
}
}
\keyword{data.setup}

